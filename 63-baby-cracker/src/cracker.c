#include <stdio.h>
#include <string.h>

char *start = "hkcert24{";
char *k = "\xce\x21\xdb\x64\xd1\x50\xe0\x1b\x0d\x3e\xfb\x0a\x52\x2f\x94\x9d\xaf\xb1\x58\x6b\x8a\xee\xc1\xf0\xfc\x19\x0a\xe3\xe9\x1e\xd0\x4a\x62\xf2\x47\xa8\x20\x0b\xd3\x6c\x1c\x1c\x56\x5b\x9b\xb3\x4d\x3d\xce\x83\x80\xc0\xe6\x7e\xe8\x09\xbd\x14\xc4\x47\xa1\xf6\x2f\xd1\x31\x5c\x1e\x10\xd1\x2a\xe0\x53\x45\xfe\x85\x58\xa6\xad\x03\xcc\x10\x4b\xd3\x94\xfe\x62\x85\x4e\x4a\x27\x35\xe2\x94\x0f\x49\x91\x86\xd7\x80\x35\x4c\x67\xc3\xaa\x3c\x67\xe8\x3f\xe4\x67\x23\xde\x8e\x2d\x46\x25\x36\xe1\xf3\x90\x7d\x0f\xb9\x14\x8c\xe7\xb6\xa6\x1a\x90\x80\x79\x85\x35\xfd\x51\x8c\x10\xe9\x3f\x32\xcc\x4b\xb5\x42\xde\xf5\x57\x13\xc8\x09\x9b\x4d\x19\x84\x91\x5f\x9d\x77\x30\x31\xc7\x28\x8d\x1d\xf4\x71\xe4\xd1\xa3\x0c\x07\x59\xaa\x0d\xad\x16\x35\x40\xb9\x28\x6a\xb5\x4c\x24\x5a\x8d\xa6\xa6\xc4\x56\xdd\xc0\x9b\xbf\xcc\xde\x0c\x5b\xc1\x75\xdd\x77\xbb\xf6\x2b\x43\x1d\x13\x03\xad\x73\xa3\xac\x4d\xea\xa5\x2f\xc2\x3e\x4a\x1a\xf5\x65\x72\xe5\x4a\x10\x10\x8c\xfb\x10\x0a\x4d\x79\x71\xf6\xc7\x80\x54\x64\xb0\x02\xaa\xd8\x7c\x39\x53\xec\xad\xb4\x4e\x2f\xeb\xe0\x47";

int main(int argc, char** argv) {
    char flag[0x100];
    printf("Enter the flag: ");
    scanf("%s", &flag);

    if (strstr(flag, start) != flag) {
        goto fail;
    }
    
    // condition check at the end
    int len = strlen(flag);
    
    if (strchr(flag, '}') != flag+len-1) {
        goto fail;
    }

    // a few binary simple equations at the end
    // hkcert24{s1m4le_cr4ckM3_4_h4ndByhan6_cha1}
    if (flag[len-2] - 48 != 1) {
        goto fail;
    }

    if (flag[len-3] + flag[len-4] + flag[len-5] != 300) {
        goto fail;
    }

    if (2*flag[len-3] + flag[len-4] + 2*flag[len-5] != 496) {
        goto fail;
    }

    if (flag[len-3] + 3*flag[len-4] + flag[len-5] != 508) {
        goto fail;
    }


    // xor middle
    int match = 0;
    char *target = "\xbd\x10\xb6\x50\xbd\x35\xbf\x78\x7f\x0a\x98\x61\x1f\x1c\xcb\xa9\xf0\xd9\x6c\x05\xee\xac\xb8\x98\x9d\x77\x3c\xbc\x81\x2e\xa0\x79\x3d\x8b\x77\xdd\x7f\x6f\xe3\x02\x2b\x43\x38\x68\xa8\xd7\x12\x0a\xa1\xdc\xf5\xf3\x83\x21\xdc\x67\xda\x66\x9b\x77\xd3\xa9\x55\xe2\x6e\x3a\x2e\x62\x8e\x5e\x88\x62\x36\xa1\xe7\x2d\x91\xf2\x32\x93\x67\x7b\xbd\xf0\xcd\x10\xda\x7f\x2c\x78\x56\x8a\xa0\x38\x2e\xe1\xb1\x88\xb0\x47\x13\x04\xf7\xc4\x63\x14\xdb\x0c\xbb\x13\x4b\xef\xbb\x72\x24\x14\x59\x83\x90\xa4\x09\x69\xcc\x7a\xe2\x9e\x8c\x8f\x69\xa1\xed\x4d\xe9\x50\xa2\x32\xfe\x24\x8a\x54\x7f\xff\x14\x81\x1d\xb6\xc1\x39\x77\x8a\x70\xf3\x2c\x77\xb2\xce\x37\xad\x07\x03\x6e\xbe\x18\xf8\x42\x90\x41\x8a\xe6\xfc\x62\x34\x6a\xce\x52\x9a\x79\x6a\x35\x8a\x4d\x35\x81\x22\x43\x28\xd2\x96\xd4\x9b\x2c\xee\x9f\xfd\x8f\xbe\x81\x78\x33\xf0\x06\x82\x15\xce\xc1\x74\x72\x42\x64\x33\xc3\x17\x90\xde\x12\xdb\xc3\x70\xa1\x56\x7e\x2d\x92\x15\x45\xba\x7a\x62\x4f\xef\xcf\x7e\x55\x3e\x4a\x42\xa9\xb3\xe8\x65\x51\xef\x60\x9b\xb7\x1e\x5a\x67\x98\xcb\xc1\x20\x41\x92\xda\x6e";
    int i = 0;
    for (; i < len - 14; i++) {
        if ((flag[i + 9] ^ k[i]) == target[i]) {
            match++;
        } else {
            break;
        }
    }

    // printf("%d", match);
    // len check
    if (match != 28 || i != len - 14) {
        goto fail;
    }

    printf("You are now verified!\n");
    return 0;

fail:
    printf("Bye\n");
    return -1;
}
